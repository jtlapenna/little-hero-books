{
  "name": "Amazon \u2192 LLM \u2192 Renderer \u2192 POD (Flow A)",
  "nodes": [
    {
      "id": "cron",
      "type": "cron",
      "params": {
        "schedule": "*/10 * * * *"
      }
    },
    {
      "id": "list_orders",
      "type": "httpRequest",
      "params": {
        "url": "https://sellingpartnerapi-na.amazon.com/orders/v0/orders",
        "method": "GET",
        "notes": "Use middleware or credentials to sign SP-API requests. Filter for Unshipped."
      }
    },
    {
      "id": "get_items",
      "type": "httpRequest",
      "params": {
        "url": "https://sellingpartnerapi-na.amazon.com/orders/v0/orders/{{$json.OrderId}}/orderItems",
        "method": "GET"
      }
    },
    {
      "id": "normalize",
      "type": "function",
      "params": {
        "code": "// map Amazon Custom fields \u2192 {child, options, shipping} schema"
      }
    },
    {
      "id": "llm",
      "type": "httpRequest",
      "params": {
        "url": "{{ $env.LLM_URL }}",
        "method": "POST",
        "notes": "Send strict manuscript_prompt; expect JSON"
      }
    },
    {
      "id": "renderer",
      "type": "httpRequest",
      "params": {
        "url": "{{ $env.RENDERER_BASE_URL }}/render",
        "method": "POST"
      }
    },
    {
      "id": "pod_order",
      "type": "httpRequest",
      "params": {
        "url": "{{ $env.POD_BASE_URL }}/orders",
        "method": "POST"
      }
    },
    {
      "id": "persist",
      "type": "googleSheets",
      "params": {
        "action": "appendRow",
        "notes": "Record orderId, podOrderId, pdf urls, status"
      }
    }
  ]
}